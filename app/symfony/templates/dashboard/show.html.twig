{% extends 'base.html.twig' %}

{% block title %}Post{% endblock %}

{% block body %}
    <div class="row mb-2 pt-4">
        <h1>Your Posts</h1>

        <table class="table">
            <tbody>
            <tr>
                <th>Id</th>
                <td>{{ post.id }}</td>
            </tr>
            <tr>
                <th>Title</th>
                <td>{{ post.title }}</td>
            </tr>
            <tr>
                <th>Date</th>
                <td>{{ post.date ? post.date|date('Y-m-d') : '' }}</td>
            </tr>
            <tr>
                <th>Content</th>
                <td>{{ post.content }}</td>
            </tr>
            <tr>
                <th>Current Status</th>
                <td>{{ post.status }}</td>
            </tr>
            </tbody>
        </table>

        {% if is_granted(constant('App\\Config\\Roles::Moderator').value) %}
            {% set publish = constant('App\\Config\\PostStatus::Published').name %}
            {% set reject = constant('App\\Config\\PostStatus::Rejected').name %}
            {{ form_start(form) }}
            <div class="d-grid gap-2 d-md-block">
                {% if form[publish] is defined %}
                    <button
                            id="{{ form[publish].vars.id }}"
                            class="{{ form[publish].vars.attr.class }}"
                            name="{{ form[publish].vars.full_name }}"
                            type="submit">
                        {{ form[publish].vars.label }}
                    </button>
                    {% do form[publish].setRendered %}
                {% endif %}
                {% if form[reject] is defined %}
                    <button
                            id="{{ form[reject].vars.id }}"
                            class="{{ form[reject].vars.attr.class }}"
                            name="{{ form[reject].vars.full_name }}"
                            type="submit">
                        {{ form[reject].vars.label }}
                    </button>
                    {% do form[reject].setRendered %}
                {% endif %}
                {{ form_rest(form) }}
                {{ form_end(form) }}
            </div>
        {% endif %}

        <div>
            <a href="{{ path('app_dashboard') }}" class="btn btn-primary">back to list</a>
            <a href="{{ path('dashboard_post_edit', {'id': post.id}) }}" class="btn btn-primary">edit</a>
            {{ include('dashboard/_delete_form.html.twig') }}
        </div>
    </div>
{% endblock %}
